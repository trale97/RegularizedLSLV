### Composite-based
corr3 <- matrix(c(1, .6, .7, rep(0,6), -.02*.9,
                  .6, 1, .5, rep(0,6), -.02*.81,
                  .7, .5, 1, rep(0,6), -.02*.86,
                  rep(0,3), 1, .6, .7, rep(0,3), .9*.15,
                  rep(0,3), .6, 1, .5, rep(0,3), .81*.15,
                  rep(0,3), .7, .5, 1, rep(0,3), .86*.15,
                  rep(0,6), 1, .6, .7, .9*.5,
                  rep(0,6), .6, 1, .5, .81*.5,
                  rep(0,6), .7, .5, 1, .86*.5,
                  -0.02*.9, -0.02*.81, -.02*.86, .9*.15, .81*.15, .86*.15, .9*.5, .81*.5, .86*.5, 1), 10, 10, byrow = T)

corr5 <- matrix(c(1, 0.4, 0.5, 0.6, 0.7, rep(0,10), -.02*.75,
                  0.4, 1, 0.6, 0.6,	0.7, rep(0,10), -.02*.77,
                  0.5, 0.6, 1, 0.6,	0.6, rep(0,10), -.02*.79,
                  0.6, 0.6, 0.6, 1,	0.6, rep(0,10), -.02*.81,
                  0.7, 0.7,	0.6, 0.6, 1, rep(0,10), -.02*.85,
                  rep(0,5), 1, 0.4, 0.5, 0.6, 0.7, rep(0,5), .15*.75,
                  rep(0,5), 0.4, 1, 0.6, 0.6,	0.7, rep(0,5), .15*.77,
                  rep(0,5), 0.5, 0.6, 1, 0.6,	0.6, rep(0,5), .15*.79,
                  rep(0,5), 0.6, 0.6, 0.6, 1,	0.6, rep(0,5), .15*.81,
                  rep(0,5), 0.7, 0.7,	0.6, 0.6, 1, rep(0,5), .15*.85,
                  rep(0,10), 1, 0.4, 0.5, 0.6, 0.7, .5*.75,
                  rep(0,10), 0.4, 1, 0.6, 0.6, 0.7, .5*.77,
                  rep(0,10), 0.5, 0.6, 1, 0.6, 0.6, .5*.79,
                  rep(0,10), 0.6, 0.6, 0.6, 1, 0.6, .5*.81,
                  rep(0,10), 0.7, 0.7, 0.6, 0.6, 1, .5*.85,
                  -.02*.75, -.02*.77, -.02*.79, -.02*.81, -.02*.85,
                  .15*.75, .15*.77, .15*.79, .15*.81, .15*.85, 
                  .5*.75, .5*.77, .5*.79, .5*.81, .5*.85, 1), 16, 16, byrow = T)

corr7 <- matrix(c(1,	0.4,	0.4,	0.4,	0.4,	0.5,	0.5, rep(0,14), -.02*.77,
                  0.4,	1,	0.4,	0.4,	0.5,	0.4,	0.5, rep(0,14), -.02*.77,
                  0.4,	0.4,	1,	0.4,	0.5,	0.5,	0.4, rep(0,14), -.02*.8,
                  0.4,	0.4,	0.4,	1,	0.4,	0.5,	0.5, rep(0,14), -.02*.81,
                  0.4,	0.5,	0.5,	0.4,	1,	0.4,	0.4, rep(0,14), -.02*.81,
                  0.5,	0.4,	0.5,	0.5,	0.4,	1,	0.4, rep(0,14), -.02*.84,
                  0.5,	0.5,	0.4,	0.5,	0.4,	0.4,	1, rep(0,14), -.02*.85,
                  rep(0,7), 1,	0.4,	0.4,	0.4,	0.4,	0.5,	0.5, rep(0,7), .15*.77,
                  rep(0,7), 0.4,	1,	0.4,	0.4,	0.5,	0.4,	0.5, rep(0,7), .15*.77,
                  rep(0,7), 0.4,	0.4,	1,	0.4,	0.5,	0.5,	0.4, rep(0,7), .15*.8,
                  rep(0,7), 0.4,	0.4,	0.4,	1,	0.4,	0.5,	0.5, rep(0,7), .15*.81,
                  rep(0,7), 0.4,	0.5,	0.5,	0.4,	1,	0.4,	0.4, rep(0,7), .15*.81,
                  rep(0,7), 0.5,	0.4,	0.5,	0.5,	0.4,	1,	0.4, rep(0,7), .15*.84,
                  rep(0,7), 0.5,	0.5,	0.4,	0.5,	0.4,	0.4,	1, rep(0,7), .15*.85,
                  rep(0,14), 1,	0.4,	0.4,	0.4,	0.4,	0.5,	0.5, .5*.77,
                  rep(0,14), 0.4,	1,	0.4,	0.4,	0.5,	0.4,	0.5, .5*.77,
                  rep(0,14), 0.4,	0.4,	1,	0.4,	0.5,	0.5,	0.4, .5*.8,
                  rep(0,14), 0.4,	0.4,	0.4,	1,	0.4,	0.5,	0.5, .5*.81,
                  rep(0,14), 0.4,	0.5,	0.5,	0.4,	1,	0.4,	0.4, .5*.81,
                  rep(0,14), 0.5,	0.4,	0.5,	0.5,	0.4,	1,	0.4, .5*.84,
                  rep(0,14), 0.5,	0.5,	0.4,	0.5,	0.4,	0.4,	1, .5*.85,
                  -.02*.77, -.02*.77, -.02*.8, -.02*.81, -.02*.81, -.02*.84, -.02*.85,
                  .15*.77, .15*.77, .15*.8, .15*.81, .15*.81, .15*.84, .15*.85,
                  .5*.77, .5*.77, .5*.8, .5*.81, .5*.81, .5*.84, .5*.85, 1), 22, 22, byrow = T)

Ptrue1 <- matrix(c(.9, .81, .86, rep(0,9), .9, .81, .86, rep(0,9), .9, .81, .86), nrow = 9, ncol = 3, byrow = F)
Ptrue2 <- matrix(c(0.75,	0.77,	0.79,	0.81,	0.85, 
                   rep(0,15), 0.75,	0.77,	0.79,	0.81,	0.85, 
                   rep(0,15), 0.75,	0.77,	0.79,	0.81,	0.85), nrow = 15, ncol = 3, byrow = F)
Ptrue3 <- matrix(c(0.77,	0.77,	0.8,	0.81,	0.81,	0.84,	0.85, rep(0,21),
                   0.77,	0.77,	0.8,	0.81,	0.81,	0.84,	0.85, rep(0,21),
                   0.77,	0.77,	0.8,	0.81,	0.81,	0.84,	0.85), nrow = 21)

w1 <- matrix(c(.41, .37, .39, rep(0,9), .41, .37, .39, rep(0,9), .41, .37, .39), nrow = 9, ncol = 3, byrow = F)
w2 <- matrix(c(0.22,	0.21,	0.26,	0.25,	0.24, rep(0,15), 
               0.22,	0.21,	0.26,	0.25,	0.24, rep(0,15), 
               0.22,	0.21,	0.26,	0.25,	0.24), nrow = 15, ncol = 3, byrow = F)
w3 <- matrix(c(0.15, 0.15,	0.22,	0.22,	0.25,	0.26,	0.3, rep(0,21),
               0.15, 0.15,	0.22,	0.22,	0.25,	0.26,	0.3, rep(0,21),
               0.15, 0.15,	0.22,	0.22,	0.25,	0.26,	0.3), nrow = 21)

### Factor-based
corr3_f <- matrix(c(1, .7*.8, .7*.9, rep(0,6), -.02*.7,
                    .7*.8, 1, .8*.9, rep(0,6), -.02*.8,
                    .7*.9, .9*.8, 1, rep(0,6), -.02*.9,
                    rep(0,3), 1, .7*.8, .7*.9, rep(0,3), .15*.7,
                    rep(0,3), .7*.8, 1, .8*.9, rep(0,3), .15*.8,
                    rep(0,3), .7*.9, .9*.8, 1, rep(0,3), .15*.9,
                    rep(0,6), 1, .7*.8, .7*.9, .7*.5,
                    rep(0,6), .7*.8, 1, .8*.9, .8*.5,
                    rep(0,6), .7*.9, .9*.8, 1, .9*.5,
                    -.02*.7, -.02*.8, -.02*.9, .15*.7, .15*.8, .15*.9, .5*.7, .5*.8, .5*.9, 1
), 10, 10, byrow = T)

corr5_f <- matrix(c(1, .6^2, .6*.7, .6*.8, .6*.8, rep(0,10), -.02*.6,
                    .6^2, 1, .6*.7, .6*.8, .6*.8, rep(0,10), -.02*.6,
                    .6*.7, .6^2, 1, .7*.8, .7*.8, rep(0,10), -.02*.7,
                    .8*.6, .8*.6, .8*.7, 1, .8*.8, rep(0,10), -.02*.8,
                    .8*.6, .8*.6, .8*.7, .8*.8, 1, rep(0,10), -.02*.8,
                    rep(0,5), 1, .6^2, .6*.7, .6*.8, .6*.8, rep(0,5), .15*.6,
                    rep(0,5), .6^2, 1, .6*.7, .6*.8, .6*.8, rep(0,5), .15*.6,
                    rep(0,5), .6*.7, .6^2, 1, .7*.8, .7*.8, rep(0,5), .15*.7,
                    rep(0,5), .8*.6, .8*.6, .8*.7, 1, .8*.8, rep(0,5), .15*.8,
                    rep(0,5), .8*.6, .8*.6, .8*.7, .8*.8, 1, rep(0,5), .15*.8,
                    rep(0,10), 1, .6^2, .6*.7, .6*.8, .6*.8, .5*.6,
                    rep(0,10), .6^2, 1, .6*.7, .6*.8, .6*.8, .5*.6,
                    rep(0,10), .6*.7, .6^2, 1, .7*.8, .7*.8, .5*.7,
                    rep(0,10), .8*.6, .8*.6, .8*.7, 1, .8*.8, .5*.8,
                    rep(0,10), .8*.6, .8*.6, .8*.7, .8*.8, 1, .5*.8,
                    -.02*.6, -.02*.6, -.02*.7, -.02*.8, -.02*.8,
                    .15*.6, .15*.6, .15*.7, .15*.8, .15*.8,
                    .5*.6, .5*.6, .5*.7, .5*.8, .5*.8, 1), 16, 16, byrow = T)

PSI1 <- diag(1-rowSums(Ptrue7f^2))
SIGMA1 <- Ptrue7f%*%t(Ptrue7f)+PSI1 
y <- c(-.02*.6, -.02*.6, -.02*.7, -.02*.7, -.02*.7, -.02*.8, -.02*.8,
       .15*.6, .15*.6, .15*.7, .15*.7, .15*.7, .15*.8, .15*.8,
       .5*.6, .5*.6, .5*.7, .5*.7, .5*.7, .5*.8, .5*.8)
ty <- c(-.02*.6, -.02*.6, -.02*.7, -.02*.7, -.02*.7, -.02*.8, -.02*.8,
        .15*.6, .15*.6, .15*.7, .15*.7, .15*.7, .15*.8, .15*.8,
        .5*.6, .5*.6, .5*.7, .5*.7, .5*.7, .5*.8, .5*.8, 1)
a <- cbind(SIGMA1, c(-.02*.6, -.02*.6, -.02*.7, -.02*.7, -.02*.7, -.02*.8, -.02*.8,
                     .15*.6, .15*.6, .15*.7, .15*.7, .15*.7, .15*.8, .15*.8,
                     .5*.6, .5*.6, .5*.7, .5*.7, .5*.7, .5*.8, .5*.8))
corr7_f <- rbind(a, c(-.02*.6, -.02*.6, -.02*.7, -.02*.7, -.02*.7, -.02*.8, -.02*.8,
                      .15*.6, .15*.6, .15*.7, .15*.7, .15*.7, .15*.8, .15*.8,
                      .5*.6, .5*.6, .5*.7, .5*.7, .5*.7, .5*.8, .5*.8, 1))

Ptrue3_f <- matrix(c(.7, .8, .9, rep(0,9), .7, .8, .9, rep(0,9), .7, .8, .9), nrow = 9, ncol = 3, byrow = F)
Ptrue5_f <- matrix(c(.6, .6, .7, .8, .8, rep(0, 15), .6, .6, .7, .8, .8, rep(0, 15), .6, .6, .7, .8, .8), ncol = 3)
Ptrue7_f <- matrix(c(.6, .6, .7, .7, .7, .8, .8, rep(0,21), .6, .6, .7, .7, .7, .8, .8, rep(0,21), .6, .6, .7, .7, .7, .8, .8), ncol = 3)
